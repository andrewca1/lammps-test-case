# mesoscopic heat conduction
# heat flow from hot right region to cold left region
# compare the temperature profile at the end opf the simulation,
# contained in file dump.last, to analytic solution.
#
#
dimension       2
units		si
atom_style	meso
boundary        f f p # At the moment we only focus on 2D so fixed in x and y

# Adding a new property - need to be added before simulation box
fix   	        prop all property/atom d_cA d_dcA d_cB d_dcB d_cC d_dcC

lattice		sq 0.005
region		box block 0 50 0 50 0 0.1
create_box	2 box
# create_atoms	1 random 1000 12345 box
create_atoms 	1 box
mass            1 1.0e-5
mass		2 1.0e-5

variable        T equal 50.0
variable        dt equal 0.025
variable        nrun equal ${T}/${dt}

region          inletA block EDGE 4.9 EDGE EDGE EDGE EDGE
region          inletB block 44.9 EDGE EDGE EDGE EDGE EDGE
set             atom * meso/rho 0.1 # mesoscopic density is also needed for this pair style
set             group all type 1
# For correct temperature profiles, mescoscopic density and mass * number density must coincide!

# create cylinder, no diffusion
region          r1 cylinder z 8 30 2 EDGE EDGE
region          r2 cylinder z 2 25 4 EDGE EDGE
region          r3 cylinder z 10 15 4 EDGE EDGE
region          r4 cylinder z 25 20 6 EDGE EDGE
region          r5 cylinder z 30 8 3 EDGE EDGE
region          r6 cylinder z 40 25 6 EDGE EDGE
region          r7 cylinder z 30 40 8 EDGE EDGE
region          rcylinder union 7 r1 r2 r3 r4 r5 r6 r7
set	        region rcylinder type 2

# Test adding the new property
set		group all d_cA 0.0
set             region inletA d_cA 2.0
set		group all d_cB 0.0
set             region inletB d_cB 2.0
set		group all d_cC 0.0

set             region rcylinder d_cA 0.0
set             region rcylinder d_cB 0.0
set             region rcylinder d_cC 0.0

pair_style      hybrid/overlay sph/concAreactiondiffusion sph/concBreactiondiffusion sph/concCreactiondiffusion
#               i j diffusion decay coeff. cutoff
pair_coeff      1 1 sph/concAreactiondiffusion 1.0e-4 100.0e-4   2.0e-2
pair_coeff      1 1 sph/concBreactiondiffusion 1.0e-4 100.0e-4   2.0e-2
pair_coeff      1 1 sph/concCreactiondiffusion 1.0e-4 100.0e-4   2.0e-2

pair_coeff      1 2 sph/concAreactiondiffusion 0.0 0.0  2.0e-2
pair_coeff      2 2 sph/concAreactiondiffusion 0.0 0.0  2.0e-2
pair_coeff      1 2 sph/concBreactiondiffusion 0.0 0.0  2.0e-2
pair_coeff      2 2 sph/concBreactiondiffusion 0.0 0.0  2.0e-2
pair_coeff      1 2 sph/concCreactiondiffusion 0.0 0.0  2.0e-2
pair_coeff      2 2 sph/concCreactiondiffusion 0.0 0.0  2.0e-2


timestep        ${dt}
neighbor	0.2e-2 bin
fix 		concA_fix all meso/concentrationA
fix 		concB_fix all meso/concentrationB
fix             concC_fix all meso/concentrationC

dump		dump_fix all custom 10 dump.heat id type x y z d_cA d_cB d_cC
dump_modify     dump_fix first yes
run             ${nrun}
undump          dump_fix

dump		dump_fix all custom 10 dump_${T}.last id type x y z d_cA d_cB d_cC
dump_modify     dump_fix first yes
run             0
undump          dump_fix

dump		dump_fix all custom 10 dump_${T}.last.xs id type xs ys zs d_cA d_cB d_cC
dump_modify     dump_fix first yes
run             0
undump          dump_fix
